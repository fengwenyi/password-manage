<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>密码管理</title>
	<!-- 
		Tell the browser to be responsive to screen width
		告诉浏览器对屏幕宽度的响应
	-->
	<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
	<!-- Bootstrap 3.3.7 -->
	<link rel="stylesheet" href="./AdminLTE-2.4.5/bower_components/bootstrap/dist/css/bootstrap.min.css">
	<!-- Font Awesome -->
	<link rel="stylesheet" href="./AdminLTE-2.4.5/bower_components/font-awesome/css/font-awesome.min.css">
	<!-- Ionicons -->
	<link rel="stylesheet" href="./AdminLTE-2.4.5/bower_components/Ionicons/css/ionicons.min.css">
	<!-- jvectormap -->
	<link rel="stylesheet" href="./AdminLTE-2.4.5/bower_components/jvectormap/jquery-jvectormap.css">
	<!-- DataTables -->
  <link rel="stylesheet" href="./AdminLTE-2.4.5/bower_components/datatables.net-bs/css/dataTables.bootstrap.min.css">
	<!-- Theme style -->
	<link rel="stylesheet" href="./AdminLTE-2.4.5/dist/css/AdminLTE.min.css">
	<!-- AdminLTE Skins. Choose a skin from the css/skins
		folder instead of downloading all of them to reduce the load. -->
		<link rel="stylesheet" href="./AdminLTE-2.4.5/dist/css/skins/_all-skins.min.css">

		<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

	<!-- Google Font -->
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic">

	<style>
		.xfsyClear {
			clear: both;
		}
		.main-container {
			margin-top: 20px;
			margin-left: 10px;
			margin-right: 10px;
		}
		.main-container .operationPanel {
			border-left: 2px solid #00a65a;
			padding-top: 10px;
			padding-bottom: 10px;
			background-color: #fff;
		}
		.main-container .operationPanel > table {
			margin-left: 10px;
		}
		.main-container .operationPanel > table .btn {
			width: 100px;
		}
		.main-container .addPanel {
			display: none;
		}

		.listPanel {
			width: 100%;
			background-color: #fff;
			padding-bottom: 50px;
			padding-top: 20px;
		}

		.appInfoPanel {
			display: none;
		}

		.authPanel {
			display: none;
		}
	</style>
</head>
<body class="hold-transition skin-green sidebar-mini">
	<div class="wrapper">

		<header class="main-header">

			<!-- Logo -->
			<a href="./admin.html" class="logo">
				<!-- test Logo -->
				<span class="logo-mini"><b>PM</b></span>
				<span class="logo-lg"><b>P</b>assword <b>M</b>anage</span>
			</a>

			<!-- Header Navbar: style can be found in header.less -->
			<nav class="navbar navbar-static-top">
				<!-- Sidebar toggle button-->
				<a href="#" class="sidebar-toggle" data-toggle="push-menu" role="button">
					<span class="sr-only">Toggle navigation</span>
				</a>
				<!-- Navbar Right Menu -->
				<div class="navbar-custom-menu">
					<ul class="nav navbar-nav">
						<!-- User Account: style can be found in dropdown.less -->
						<li class="dropdown user user-menu">
							<a href="#" class="dropdown-toggle" data-toggle="dropdown">
								<img src="./images/header.jpg" class="user-image" alt="User Image">
								<span class="hidden-xs">冯文议</span>
							</a>
							<ul class="dropdown-menu">
								<!-- User image -->
								<li class="user-header">
									<img src="./images/header.jpg" class="img-circle" alt="User Image">

									<p>
										冯文议-Java开发工程师
										<small>2014起</small>
									</p>
								</li>
								<!-- Menu Footer-->
								<li class="user-footer">
									<div class="pull-right">
										<a href="#" class="btn btn-default btn-flat">退出</a>
									</div>
								</li>
								<div class="xfsyClear"></div>
							</ul>
						</li>
					</ul>
				</div>

			</nav>
		</header>


		<!-- Left side column. contains the logo and sidebar -->
		<aside class="main-sidebar">
			<!-- sidebar: style can be found in sidebar.less -->
			<section class="sidebar">
				<!-- Sidebar user panel -->
				<div class="user-panel">
					<div class="pull-left image">
						<img src="./images/header.jpg" class="img-circle" alt="User Image">
					</div>
					<div class="pull-left info">
						<p>冯文议</p>
						<a href="#"><i class="fa fa-circle text-success"></i> 工作中</a>
					</div>
				</div>
				<!-- search form -->
				<form action="#" method="get" class="sidebar-form">
					<div class="input-group">
						<input type="text" name="q" class="form-control" placeholder="Search...">
						<span class="input-group-btn">
							<button type="submit" name="search" id="search-btn" class="btn btn-flat">
								<i class="fa fa-search"></i>
							</button>
						</span>
					</div>
				</form>
				<!-- /.search form -->
				<!-- sidebar menu: : style can be found in sidebar.less -->
				<!-- 菜单开始 -->
				<ul class="sidebar-menu" data-widget="tree">
					<li>
						<a href="./admin.html">
							<i class="fa fa-dashboard"></i> <span>系统首页</span>
						</a>
					</li>

					<li class="active">
						<a href="./admin.html">
							<i class="fa fa-expeditedssl"></i> <span>密码管理</span>
						</a>
					</li>
				</ul>
			</section>
			<!-- /.sidebar -->
		</aside>

		<!-- Content Wrapper. Contains page content -->
		<div class="content-wrapper">
			<!-- Content Header (Page header) -->
			<section class="content-header">
				<h1>
					系统首页
					<small>Version 1.0-alpha</small>
				</h1>
				<ol class="breadcrumb">
					<li><a href="#"><i class="fa fa-dashboard"></i> 系统首页</a></li>
				</ol>
			</section>

			<!-- Main content -->
			
			<div class="main-container">
				<!-- 新增 列表 -->
				<div class="operationPanel">
					<table>
						<tr>
							<td><button type="button" class="btn btn-block btn-success" onclick="addPanel()">新增</button></td>
						</tr>
					</table>
				</div>

				<!-- 添加应用 -->
				<div class="addPanel" id="addPanel">
					<div class="box box-success form">
						<div class="box-header with-border">
							<h3 class="box-title">新增应用</h3>
						</div>

						<form role="form" id="formAddApp" action="javascript:;" method="post">
							<div class="box-body">
								<div class="form-group">
									<label for="name">应用</label>
									<input type="text" class="form-control" name="name" placeholder="请输入应用名称">
								</div>
								<div class="">
									<label for="account">账号</label>
									<input type="text" class="form-control" name="account" placeholder="请输入账号">
								</div>
								<div class="form-group">
									<label for="password">密码</label>
									<input type="password" class="form-control" name="password" placeholder="请输入密码">
								</div>
								<div class="form-group">
									<label for="explain">备注</label>
									<textarea class="form-control" rows="3" name="explain" placeholder="Enter ..."></textarea>
								</div>
							</div>

							<div class="box-footer">
								<button type="submit" class="btn btn-success" onclick="addApp(); return false">提交</button>
		              		</div>
		            	</form>
		          </div>
				</div>

				<!-- 验证 -->
				<div class="authPanel" id="authPanel">
					<div class="box box-success form">
						<div class="box-header with-border">
							<h3 class="box-title">身份验证</h3>
						</div>

						<form role="form" id="formAuth" action="javascript:;" method="post">
							<div class="box-body">
								<div class="">
									<label for="account">用户名</label>
									<input type="text" class="form-control" name="username" placeholder="请输入用户名">
								</div>
								<div class="form-group">
									<label for="password">密码</label>
									<input type="password" class="form-control" name="password" placeholder="请输入密码">
								</div>
							</div>

							<div id="appId" style="display: none;"></div>

							<div class="box-footer">
								<button type="submit" class="btn btn-success" onclick="getAppInfo(); return false">验证</button>
		              		</div>
		            	</form>
		          </div>
				</div>

				<!-- 应用信息面板 -->
				<div class="appInfoPanel" id="appInfoPanel">
					<div class="box box-success form">
						<div class="box-header with-border">
							<h3 class="box-title">应用信息</h3>
						</div>
						<div class="box-body">
							<div class="form-group">
								<label for="name">应用</label>
								<div id="appInfoName"></div>
							</div>
							<div class="">
								<label for="account">账号</label>
								<div id="appInfoAccount"></div>
							</div>
							<div class="form-group">
								<label for="password">密码</label>
								<div id="appInfoPassword"></div>
							</div>
							<div class="form-group">
								<label for="explain">备注</label>
								<div id="appInfoExplain"></div>
							</div>
						</div>
		          </div>
				</div>
				<div class="listPanel">
		          	
		          	<div class="box-body">
		              <table class="table table-striped table-hover">
		                <thead>
		                <tr>
		                  <th>ID</th>
		                  <th>名称</th>
		                  <th width="200">创建时间</th>
		                  <th width="200">修改时间</th>
		                  <th>操作</th>
		                </tr>
		                </thead>
		                <tbody id="appData">
		                </tfoot>
		              </table>
		            </div>

		        </div>
			</div>

			<!-- /.content -->
		</div>
		<!-- /.content-wrapper -->

		<footer class="main-footer">
			<div class="pull-right hidden-xs">
				<b>Version</b> 1.0-alpha
			</div>
			<strong>Copyright &copy; 2018 <a href="http://fengwenyi.com">Wenyi Feng</a>.</strong> All rights
			reserved.
		</footer>

		<!-- Control Sidebar -->

		<!-- /.control-sidebar -->
	<!-- Add the sidebar's background. This div must be placed
		immediately after the control sidebar -->
		<div class="control-sidebar-bg"></div>

	</div>
	<!-- ./wrapper -->

	<!-- jQuery 3 -->
	<script src="./AdminLTE-2.4.5/bower_components/jquery/dist/jquery.min.js"></script>
	<!-- Bootstrap 3.3.7 -->
	<script src="./AdminLTE-2.4.5/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
	<!-- FastClick -->
	<script src="./AdminLTE-2.4.5/bower_components/fastclick/lib/fastclick.js"></script>
	<!-- AdminLTE App -->
	<script src="./AdminLTE-2.4.5/dist/js/adminlte.min.js"></script>
	<!-- Sparkline -->
	<script src="./AdminLTE-2.4.5/bower_components/jquery-sparkline/dist/jquery.sparkline.min.js"></script>
	<!-- jvectormap  -->
	<script src="./AdminLTE-2.4.5/plugins/jvectormap/jquery-jvectormap-1.2.2.min.js"></script>
	<script src="./AdminLTE-2.4.5/plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
	<!-- SlimScroll -->
	<script src="./AdminLTE-2.4.5/bower_components/jquery-slimscroll/jquery.slimscroll.min.js"></script>
	<!-- ChartJS -->
	<script src="./AdminLTE-2.4.5/bower_components/chart.js/Chart.js"></script>
	<!-- DataTables -->
	<script src="./AdminLTE-2.4.5/bower_components/datatables.net/js/jquery.dataTables.min.js"></script>
	<script src="./AdminLTE-2.4.5/bower_components/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>

	<script src="./js/Constant.js"></script>
	<script src="./js/TokenUtil.js"></script>
	<script src="./js/HttpUtil.js"></script>
	<script src="./layer/layer.js"></script>

	<script>
		$(function() {
			let url = HOST + '/password/getAll';
			ajaxGet(url, function(data) {
				let appAll
				$.each(data.data, function(i, item) {
					let id = item.id
					let name = item.name
					let createTime = item.createTime
					let updateTime = item.updateTime
					let htmlStr = '<tr>'
					                 + '<td>' + id + '</td>'
					                 + '<td>' + name + '</td>'
					                 + '<td>' + createTime + '</td>'
					                 + '<td>' + updateTime + '</td>'
					                 + '<td>'
					                 	+ '<button type="button" class="btn btn-default" onclick="appInfoSee(' + id + ')"><i class="fa fa-eye"></i></button>' 
					                 	+ ' <button type="button" class="btn btn-info" onclick="appInfUpdate(' + id + ')"><i class="fa fa-pencil"></i></button>'
					                 	+ ' <button type="button" class="btn btn-danger" onclick="appInfoDelete(' + id + ')"><i class="fa fa-trash"></i></button></td>'
					               + '</tr>'
					appAll = appAll + htmlStr
				})
				$('#appData').html(appAll)
			})
		})

		function addPanel() {
			layer.open({
				type: 1,
				title: false,
				closeBtn: 0,
				shadeClose: true,
				skin: 'yourclass',
				content: $('#addPanel'),
				area: ['600px']
			});
		}

		// 增加应用
		function addApp() {
			let url = HOST + '/password/addPassword'
    		let formData = $('#formAddApp').serialize()
    		ajaxPost(url, formData, function(data) {
    			let code = data.code
    			if (code === 0) {
    				layer.msg('添加成功')
    			} else {
    				layer.msg('添加失败：' + data.msg)
    			}
    		})
		}

		function appInfoSee(id) {
			//
			layer.open({
				type: 1,
				title: false,
				closeBtn: 0,
				shadeClose: true,
				skin: 'yourclass',
				content: $('#authPanel'),
				area: ['400px']
			});
			$('#appId').html(id)
		}

		function getAppInfo() {
			let formData = $('#formAuth').serialize() + '&id=' + $('#appId').html()
			console.log(formData)
			let url = HOST + '/password/getPasswordById'
			ajaxPost(url, formData, function(data) {
    			let code = data.code
    			if (code === 0) {
    				console.log(data)
    			} else {
    				layer.msg('查询失败：' + data.msg)
    			}
    		})
		}
	</script>
</body>
</html>
